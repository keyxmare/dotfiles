#!/usr/bin/env bash
set -euo pipefail

# Silence all non-echo output
exec 3>&1 4>&2
exec 1>/dev/null
exec 2>/dev/null
repo_root="$(git rev-parse --show-toplevel)"
# Run sync while showing echo output only
"$repo_root/sync.sh" 1>&3 2>&4

# Display code version from synced copy
version_file="$HOME/.local/share/dotfiles/.version"
if [ -f "$version_file" ]; then
  echo "Code version: $(cat "$version_file")" >&3
fi
